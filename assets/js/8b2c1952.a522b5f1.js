"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8512],{94030:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>a,frontMatter:()=>c,metadata:()=>d,toc:()=>l});var i=t(85893),s=t(11151);const c={title:"IBC-Go v8 to v9",sidebar_label:"IBC-Go v8 to v9",sidebar_position:13,slug:"/migrations/v8-to-v9"},r="Migrating from v8 to v9",d={id:"migrations/v8-to-v9",title:"IBC-Go v8 to v9",description:"This guide provides instructions for migrating to a new version of ibc-go.",source:"@site/docs/05-migrations/13-v8-to-v9.md",sourceDirName:"05-migrations",slug:"/migrations/v8-to-v9",permalink:"/main/migrations/v8-to-v9",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:13,frontMatter:{title:"IBC-Go v8 to v9",sidebar_label:"IBC-Go v8 to v9",sidebar_position:13,slug:"/migrations/v8-to-v9"},sidebar:"defaultSidebar",previous:{title:"IBC-Go v8 to v8.1",permalink:"/main/migrations/v8-to-v8_1"}},o={},l=[{value:"Chains",id:"chains",level:2},{value:"IBC Apps",id:"ibc-apps",level:2},{value:"API removals",id:"api-removals",level:3},{value:"API deprecation notice",id:"api-deprecation-notice",level:3},{value:"IBC testing package",id:"ibc-testing-package",level:3},{value:"IBC core",id:"ibc-core",level:3},{value:"ICS27 - Interchain Accounts",id:"ics27---interchain-accounts",level:3},{value:"Relayers",id:"relayers",level:2},{value:"IBC Light Clients",id:"ibc-light-clients",level:2},{value:"API removals",id:"api-removals-1",level:3},{value:"06-solomachine",id:"06-solomachine",level:3},{value:"07-tendermint",id:"07-tendermint",level:3},{value:"08-wasm",id:"08-wasm",level:3}];function h(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"migrating-from-v8-to-v9",children:"Migrating from v8 to v9"}),"\n",(0,i.jsx)(n.p,{children:"This guide provides instructions for migrating to a new version of ibc-go."}),"\n",(0,i.jsx)(n.p,{children:"There are four sections based on the four potential user groups of this document:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#chains",children:"Chains"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#ibc-apps",children:"IBC Apps"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#relayers",children:"Relayers"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"#ibc-light-clients",children:"IBC Light Clients"})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note:"})," ibc-go supports golang semantic versioning and therefore all imports must be updated on major version releases."]}),"\n",(0,i.jsx)(n.h2,{id:"chains",children:"Chains"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"No relevant changes were made in this release."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"ibc-apps",children:"IBC Apps"}),"\n",(0,i.jsx)(n.h3,{id:"api-removals",children:"API removals"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"exported.ChannelI"})," and ",(0,i.jsx)(n.code,{children:"exported.CounterpartyChannelI"})," interfaces have been removed. Please use the concrete types.\nThe ",(0,i.jsx)(n.code,{children:"exported.ConnectionI"})," and ",(0,i.jsx)(n.code,{children:"exported.CounterpartyConnectionI"})," interfaces have been removed. Please use the concrete types.\nThe ",(0,i.jsx)(n.code,{children:"exported.Proof"})," interface has been removed. Please use the ",(0,i.jsx)(n.code,{children:"MerkleProof"})," concrete type."]}),"\n",(0,i.jsxs)(n.p,{children:["The functions ",(0,i.jsx)(n.code,{children:"GetState()"}),", ",(0,i.jsx)(n.code,{children:"GetOrdering()"}),", ",(0,i.jsx)(n.code,{children:"GetCounterparty()"}),", ",(0,i.jsx)(n.code,{children:"GetConnectionHops()"}),", ",(0,i.jsx)(n.code,{children:"GetVersion()"})," of the ",(0,i.jsx)(n.code,{children:"Channel"})," type have been removed.\nThe functions ",(0,i.jsx)(n.code,{children:"GetPortID()"}),", ",(0,i.jsx)(n.code,{children:"GetChannelID()"})," of the ",(0,i.jsx)(n.code,{children:"CounterpartyChannel"})," type have been removed.\nThe functions ",(0,i.jsx)(n.code,{children:"GetClientID()"}),", ",(0,i.jsx)(n.code,{children:"GetState()"}),", ",(0,i.jsx)(n.code,{children:"GetCounterparty()"}),", ",(0,i.jsx)(n.code,{children:"GetVersions()"}),", and ",(0,i.jsx)(n.code,{children:"GetDelayPeriod"})," of the ",(0,i.jsx)(n.code,{children:"Connection"})," type have been removed.\nThe functions ",(0,i.jsx)(n.code,{children:"GetClientID()"}),", ",(0,i.jsx)(n.code,{children:"GetConnectionID()"}),", and ",(0,i.jsx)(n.code,{children:"GetPrefix()"})," of the ",(0,i.jsx)(n.code,{children:"CounterpartyConnection"})," type have been removed."]}),"\n",(0,i.jsxs)(n.p,{children:["The utility function ",(0,i.jsx)(n.code,{children:"QueryLatestConsensusState"})," of ",(0,i.jsx)(n.code,{children:"04-channel"})," CLI has been removed."]}),"\n",(0,i.jsx)(n.h3,{id:"api-deprecation-notice",children:"API deprecation notice"}),"\n",(0,i.jsxs)(n.p,{children:["The testing package functions ",(0,i.jsx)(n.code,{children:"coordinator.Setup"}),", ",(0,i.jsx)(n.code,{children:"coordinator.SetupClients"}),", ",(0,i.jsx)(n.code,{children:"coordinator.SetupConnections"}),", ",(0,i.jsx)(n.code,{children:"coordinator.CreateConnections"}),", and ",(0,i.jsx)(n.code,{children:"coordinator.CreateChannels"})," have been deprecated and will be removed in v10.\nPlease use the new functions ",(0,i.jsx)(n.code,{children:"path.Setup"}),", ",(0,i.jsx)(n.code,{children:"path.SetupClients"}),", ",(0,i.jsx)(n.code,{children:"path.SetupConnections"}),", ",(0,i.jsx)(n.code,{children:"path.CreateConnections"}),", ",(0,i.jsx)(n.code,{children:"path.CreateChannels"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"ibc-testing-package",children:"IBC testing package"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"mock.PV"})," type has been removed in favour of ",(0,i.jsx)(n.a,{href:"https://github.com/cometbft/cometbft/blob/v0.38.5/types/priv_validator.go#L50",children:(0,i.jsx)(n.code,{children:"cmttypes.MockPV"})})," (",(0,i.jsx)(n.a,{href:"https://github.com/cosmos/ibc-go/pull/5709",children:"#5709"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:["Functions ",(0,i.jsx)(n.code,{children:"ConstructUpdateTMClientHeader"})," and ",(0,i.jsx)(n.code,{children:"ConstructUpdateTMClientHeaderWithTrustedHeight"})," of ",(0,i.jsx)(n.code,{children:"TestChain"})," type have been replaced with ",(0,i.jsx)(n.code,{children:"IBCClientHeader"}),". This function will construct a ",(0,i.jsx)(n.code,{children:"07-tendermint"})," header to update the light client on the counterparty chain. The trusted height must be passed in as a non-zero height."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"GetValsAtHeight"})," has been renamed to ",(0,i.jsx)(n.code,{children:"GetTrustedValidators"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"AssertEventsLegacy"})," function of ",(0,i.jsx)(n.code,{children:"ibctesting"})," package (alias for ",(0,i.jsx)(n.code,{children:'"github.com/cosmos/ibc-go/v9/testing"'}),")  has been removed and ",(0,i.jsx)(n.code,{children:"AssertEvents"})," function should be used instead (ref: ",(0,i.jsx)(n.a,{href:"https://github.com/cosmos/ibc-go/pull/6070",children:"#6070"}),")."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-diff",children:"// testing/events.go\n- func AssertEventsLegacy(\n-   suite *testifysuite.Suite,\n-   expected EventsMap,\n-   actual []abci.Event,\n- )\n\nfunc AssertEvents(\n  suite *testifysuite.Suite,\n  expected []abci.Event,\n  actual []abci.Event,\n)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"ibc-core",children:"IBC core"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"Router"})," reference has been removed from IBC core keeper: ",(0,i.jsx)(n.a,{href:"https://github.com/cosmos/ibc-go/pull/6138",children:"#6138"})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"ics27---interchain-accounts",children:"ICS27 - Interchain Accounts"}),"\n",(0,i.jsxs)(n.p,{children:["In ",(0,i.jsx)(n.a,{href:"https://github.com/cosmos/ibc-go/pull/5785",children:"#5785"})," the list of arguments of the ",(0,i.jsx)(n.code,{children:"NewKeeper"})," constructor function of the host submodule was extended with an extra argument for the gRPC query router that the submodule uses when executing a ",(0,i.jsx)(n.a,{href:"https://github.com/cosmos/ibc-go/blob/eecfa5c09a4c38a5c9f2cc2a322d2286f45911da/proto/ibc/applications/interchain_accounts/host/v1/tx.proto#L41-L51",children:(0,i.jsx)(n.code,{children:"MsgModuleQuerySafe"})})," to perform queries that are module safe:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-diff",children:"func NewKeeper(\n  cdc codec.Codec, key storetypes.StoreKey, legacySubspace icatypes.ParamSubspace,\n  ics4Wrapper porttypes.ICS4Wrapper, channelKeeper icatypes.ChannelKeeper,\n  portKeeper icatypes.PortKeeper,\taccountKeeper icatypes.AccountKeeper, \n  scopedKeeper exported.ScopedKeeper, msgRouter icatypes.MessageRouter,\n+ queryRouter icatypes.QueryRouter, \n  authority string,\n) Keeper\n"})}),"\n",(0,i.jsx)(n.h2,{id:"relayers",children:"Relayers"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Renaming of event attribute keys in ",(0,i.jsx)(n.a,{href:"https://github.com/cosmos/ibc-go/pull/5603",children:"#5603"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Removal of duplicate non-hexlified event attributes in ",(0,i.jsx)(n.a,{href:"https://github.com/cosmos/ibc-go/pull/6023",children:"#6023"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"ibc-light-clients",children:"IBC Light Clients"}),"\n",(0,i.jsx)(n.h3,{id:"api-removals-1",children:"API removals"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"ExportMetadata"})," interface function has been removed from the ",(0,i.jsx)(n.code,{children:"ClientState"})," interface. Core IBC will export all key/value's within the 02-client store."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"ZeroCustomFields"})," interface function has been removed from the ",(0,i.jsx)(n.code,{children:"ClientState"})," interface."]}),"\n",(0,i.jsxs)(n.p,{children:["The following functions have also been removed from the ",(0,i.jsx)(n.code,{children:"ClientState"})," interface: ",(0,i.jsx)(n.code,{children:"Initialize"}),", ",(0,i.jsx)(n.code,{children:"Status"}),", ",(0,i.jsx)(n.code,{children:"GetLatestHeight"}),", ",(0,i.jsx)(n.code,{children:"GetTimestampAtHeight"}),", ",(0,i.jsx)(n.code,{children:"VerifyClientMessage"}),", ",(0,i.jsx)(n.code,{children:"VerifyMembership"}),", ",(0,i.jsx)(n.code,{children:"VerifyNonMembership"}),", ",(0,i.jsx)(n.code,{children:"CheckForMisbehaviour"}),", ",(0,i.jsx)(n.code,{children:"UpdateState"}),", ",(0,i.jsx)(n.code,{children:"UpdateStateOnMisbehaviour"}),",  ",(0,i.jsx)(n.code,{children:"CheckSubstituteAndUpdateState"})," and ",(0,i.jsx)(n.code,{children:"VerifyUpgradeAndUpdateState"}),". ibc-go v9 decouples routing at the ",(0,i.jsx)(n.code,{children:"02-client"})," layer from the light clients' encoding structure (i.e. every light client implementation of the ",(0,i.jsx)(n.code,{children:"ClientState"})," interface is not used anymore to route the requests to the right light client at the ",(0,i.jsx)(n.code,{children:"02-client"})," layer, instead a ",(0,i.jsx)(n.em,{children:"light client module"})," is registered for every light client type and ",(0,i.jsx)(n.code,{children:"02-client"})," routes the requests to the right light client module based on the client ID). Light client developers must implement the newly introduced ",(0,i.jsx)(n.code,{children:"LightClientModule"})," interface and are encouraged to move the logic implemented in the functions of their light client's implementation of the ",(0,i.jsx)(n.code,{children:"ClientState"})," interface to the equivalent function in the ",(0,i.jsx)(n.code,{children:"LightClientModule"})," interface. The table below shows the equivalence between the ",(0,i.jsx)(n.code,{children:"ClientState"})," interface functions that have been removed and the functions in the ",(0,i.jsx)(n.code,{children:"LightClientModule"})," interface:"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.th,{children:[(0,i.jsx)(n.code,{children:"ClientState"})," interface"]}),(0,i.jsxs)(n.th,{children:[(0,i.jsx)(n.code,{children:"LightClientModule"})," interface"]})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Initialize"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Initialize"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Status"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Status"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"GetLatestHeight"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"LatestHeight"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"GetTimestampAtHeight"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"TimestampAtHeight"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"VerifyClientMessage"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"VerifyClientMessage"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"VerifyMembership"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"VerifyMembership"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"VerifyNonMembership"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"VerifyNonMembership"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"CheckForMisbehaviour"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"CheckForMisbehaviour"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"UpdateState"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"UpdateState"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"UpdateStateOnMisbehaviour"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"UpdateStateOnMisbehaviour"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"CheckSubstituteAndUpdateState"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"RecoverClient"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"VerifyUpgradeAndUpdateState"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"VerifyUpgradeAndUpdateState"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ExportMetadata"})}),(0,i.jsx)(n.td,{})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"ZeroCustomFields"})}),(0,i.jsx)(n.td,{})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["Please check also the ",(0,i.jsx)(n.a,{href:"/main/ibc/light-clients/overview",children:"Light client developer guide"})," for more information. The light client module implementation for ",(0,i.jsx)(n.code,{children:"07-tendermint"})," may also be useful as reference."]}),"\n",(0,i.jsx)(n.h3,{id:"06-solomachine",children:"06-solomachine"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"Initialize"}),", ",(0,i.jsx)(n.code,{children:"Status"}),", ",(0,i.jsx)(n.code,{children:"GetTimestampAtHeight"})," and ",(0,i.jsx)(n.code,{children:"UpdateStateOnMisbehaviour"})," functions in ",(0,i.jsx)(n.code,{children:"ClientState"})," have been removed and all their logic has been moved to functions of the ",(0,i.jsx)(n.code,{children:"LightClientModule"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"07-tendermint",children:"07-tendermint"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"IterateConsensusMetadata"})," function has been removed."]}),"\n",(0,i.jsx)(n.h3,{id:"08-wasm",children:"08-wasm"}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"ExportMetadataMsg"})," struct has been removed and is no longer required for contracts to implement. Core IBC will handle exporting all key/value's written to the store by a light client contract.\nThe ",(0,i.jsx)(n.code,{children:"ZeroCustomFields"})," interface function has been removed from the ",(0,i.jsx)(n.code,{children:"ClientState"})," interface. Core IBC only used this function to set tendermint client states when scheduling an IBC software upgrade. The interface function has been replaced by a type assertion."]})]})}function a(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},11151:(e,n,t)=>{t.d(n,{Z:()=>d,a:()=>r});var i=t(67294);const s={},c=i.createContext(s);function r(e){const n=i.useContext(c);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(c.Provider,{value:n},e.children)}}}]);